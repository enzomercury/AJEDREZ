<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ajedrez Interdisciplinario ‚Äî Arte √ó Computaci√≥n</title>
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      :root{
        --bordo:#7a1c1c;      /* principal */
        --bordo-2:#9b2c2c;    /* secciones */
        --bordo-3:#f3d9d9;    /* fondo claro */
      }
      .fade-enter{opacity:.0;transform:scale(.98)}
      .fade-enter-active{opacity:1;transform:scale(1);transition:opacity .35s ease, transform .35s ease}
      .cell{box-shadow: inset 0 0 0 1px rgba(0,0,0,.05)}
    </style>
  </head>
  <body class="min-h-screen bg-gradient-to-b from-white to-rose-50 text-slate-900">
    <div id="root" class="p-6"></div>

    <!-- React 18 UMD + Babel (para usar JSX sin build) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- ==== App (JSX) ==== -->
    <script type="text/babel">
      const { useState, useEffect, useRef } = React;

      // ===================== Utilidades =====================
      const GALLERY_ITEMS = [
        { name: "Rey", file: "foto1.jpg" },
        { name: "Reina", file: "foto2.jpg" },
        { name: "Alfil", file: "foto3.jpg" },
        { name: "Caballo", file: "foto4.jpg" },
        { name: "Torre", file: "foto5.jpg" },
        { name: "Pe√≥n", file: "foto6.jpg" },
      ];

      function useInterval(callback, delay){
        const saved = useRef(callback);
        useEffect(()=>{ saved.current = callback; }, [callback]);
        useEffect(()=>{ if(delay===null) return; const id=setInterval(()=>saved.current(), delay); return ()=>clearInterval(id); },[delay]);
      }

      // ===================== Carrusel =====================
      function GalleryCarousel(){
        const [i, setI] = useState(0);
        const [auto, setAuto] = useState(true);
        const current = GALLERY_ITEMS[i];
        useInterval(()=> setI(prev => (prev+1)%GALLERY_ITEMS.length), auto? 4000 : null);

        return (
          <div className="relative w-full max-w-xl mx-auto">
            <div className="aspect-[4/3] rounded-2xl overflow-hidden shadow-xl" style={{background:"var(--bordo-3)"}}>
              <figure key={current.file} className="fade-enter fade-enter-active w-full h-full flex items-center justify-center">
                <img
                  src={current.file}
                  alt={current.name}
                  className="w-full h-full object-cover"
                  onError={(e)=>{
                    e.currentTarget.style.display='none';
                    const parent = e.currentTarget.parentElement;
                    if(parent && !parent.querySelector('.fallback')){
                      const div = document.createElement('div');
                      div.className='fallback flex flex-col items-center justify-center w-full h-full text-center p-6 bg-rose-100';
                      div.innerHTML = `<div class='text-6xl'>üé®</div><div class='mt-2 font-semibold'>${current.name}</div><div class='text-xs opacity-70'>Sub√≠ ${current.file} al repo</div>`;
                      parent.appendChild(div);
                    }
                  }}
                />
              </figure>
            </div>

            <div className="absolute inset-0 flex items-center justify-between p-2">
              <button onClick={()=>setI(x => (x-1+GALLERY_ITEMS.length)%GALLERY_ITEMS.length)} className="rounded-full p-2 bg-white/80 hover:bg-white shadow" aria-label="Anterior">‚óÄ</button>
              <button onClick={()=>setI(x => (x+1)%GALLERY_ITEMS.length)} className="rounded-full p-2 bg-white/80 hover:bg-white shadow" aria-label="Siguiente">‚ñ∂</button>
            </div>

            <div className="mt-3 flex items-center justify-between">
              <div className="text-sm font-medium">
                <span>{current.name}</span>
                <span className="opacity-60"> ‚Äî {current.file}</span>
              </div>
              <button onClick={()=>setAuto(a=>!a)} className="px-3 py-1.5 rounded-full border shadow-sm text-white" style={{background:"var(--bordo)"}}>
                {auto ? 'Pausar' : 'Reproducir'}
              </button>
            </div>

            <div className="mt-2 flex items-center justify-center gap-1">
              {GALLERY_ITEMS.map((_, idx)=> (
                <button key={idx} onClick={()=>setI(idx)} className={`h-2 w-6 rounded-full ${idx===i? 'bg-neutral-800':'bg-neutral-400'}`} aria-label={`Ir a imagen ${idx+1}`}></button>
              ))}
            </div>
          </div>
        );
      }

      // ===================== Tablero =====================
      const PIECES = { r:"‚ôú", n:"‚ôû", b:"‚ôù", q:"‚ôõ", k:"‚ôö", p:"‚ôü", R:"‚ôñ", N:"‚ôò", B:"‚ôó", Q:"‚ôï", K:"‚ôî", P:"‚ôô" };

      const STYLES = {
        default: { showCoords:true, sizeClass:'text-3xl', dark:'#ede2e2', light:'#ffffff' },
        minimalist: { showCoords:false, sizeClass:'text-2xl', dark:'#f6f6f6', light:'#ffffff' },
        surreal: { showCoords:true, sizeClass:'text-4xl', dark:'#f7e1e1', light:'#f0caca' },
      };

      function startingBoard(){
        const rows = ["rnbqkbnr","pppppppp","8","8","8","8","PPPPPPPP","RNBQKBNR"]; const board=[];
        for(const r of rows){ const row=[]; for(const ch of r){ if(ch==='8'){ for(let i=0;i<8;i++) row.push(null); } else { row.push(ch); } } board.push(row); }
        return board;
      }
      function randomSurrealBoard(){
        const keys = Object.keys(PIECES); const b = Array.from({length:8},()=>Array(8).fill(null));
        const count = 12 + Math.floor(Math.random()*10);
        for(let i=0;i<count;i++){ const r=Math.floor(Math.random()*8), c=Math.floor(Math.random()*8); b[r][c]=keys[Math.floor(Math.random()*keys.length)]; }
        return b;
      }

      function ChessBoard(){
        const [board, setBoard] = useState(startingBoard());
        const [selected, setSelected] = useState(null);
        const [mode, setMode] = useState('default');
        const style = STYLES[mode];

        const cellColor=(r,c)=> ((r+c)%2? style.dark : style.light);

        function onCellClick(r,c){
          const piece = board[r][c];
          if(selected){
            const [sr,sc] = selected; if(sr===r && sc===c){ setSelected(null); return; }
            const next = board.map(row=>row.slice()); next[r][c]=next[sr][sc]; next[sr][sc]=null; setBoard(next); setSelected(null);
          } else if(piece){ setSelected([r,c]); }
        }

        function exportSVG(){
          const size=64; const parts=[];
          for(let r=0;r<8;r++) for(let c=0;c<8;c++){
            const x=c*size, y=r*size; const fill=cellColor(r,c);
            parts.push(`<rect x="${x}" y="${y}" width="${size}" height="${size}" fill="${fill}"/>`);
            const p=board[r][c]; if(p){ const g=PIECES[p]; parts.push(`<text x="${x+size/2}" y="${y+size/2+12}" font-size="36" text-anchor="middle">${g}</text>`); }
          }
          const svg=`<svg xmlns="http://www.w3.org/2000/svg" width="${8*size}" height="${8*size}">${parts.join('')}</svg>`;
          const uri='data:image/svg+xml;utf8,'+encodeURIComponent(svg); window.open(uri,'_blank');
        }

        return (
          <div className="p-4 rounded-3xl shadow-2xl border" style={{borderColor:'var(--bordo)'}}>
            <div className="flex flex-wrap items-center gap-2 mb-3">
              <button onClick={()=>{setBoard(startingBoard()); setMode('default')}} className="px-3 py-2 rounded-lg shadow-sm text-white" style={{background:'var(--bordo)'}}>Reiniciar</button>
              <button onClick={()=>{setBoard(randomSurrealBoard()); setMode('surreal')}} className="px-3 py-2 rounded-lg shadow-sm text-white" style={{background:'var(--bordo-2)'}}>Surrealizar</button>
              <button onClick={()=>setMode(m=> m==='minimalist'?'default':'minimalist')} className="px-3 py-2 rounded-lg shadow-sm text-white" style={{background:'#2e7d6b'}}>Minimalismo</button>
              <button onClick={exportSVG} className="px-3 py-2 rounded-lg shadow-sm border bg-white">Exportar SVG</button>
            </div>

            <div className="inline-block rounded-xl overflow-hidden">
              <div className="grid grid-cols-8 gap-0">
                {board.map((row,r)=> row.map((cell,c)=>{
                  const sel = selected && selected[0]===r && selected[1]===c;
                  return (
                    <button key={`${r}-${c}`} onClick={()=>onCellClick(r,c)} className={`cell w-16 h-16 md:w-20 md:h-20 flex items-center justify-center relative ${sel?'ring-4':''}`} style={{background:cellColor(r,c), aspectRatio:'1/1', ...(sel?{boxShadow:`0 0 0 4px var(--bordo)`}:{})}}>
                      {cell ? <span className={`${style.sizeClass} select-none`}>{PIECES[cell]}</span> : <span className="opacity-0">.</span>}
                      {style.showCoords && <span className="absolute bottom-0 right-0 text-[9px] opacity-60 pr-1 pb-1">{String.fromCharCode(97+c)}{8-r}</span>}
                    </button>
                  );
                }))}
              </div>
            </div>
          </div>
        );
      }

      function App(){
        return (
          <div className="max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-3 gap-6">
            <aside className="p-5 rounded-2xl shadow-lg text-white" style={{background:'var(--bordo)'}}>
              <div className="flex items-center justify-between mb-2">
                <h1 className="text-2xl font-bold">Ajedrez Interdisciplinario</h1>
                <span className="text-xs bg-white/20 rounded px-2 py-1">Arte √ó Computaci√≥n</span>
              </div>
              <p className="text-sm opacity-90">Proyecto conjunto con piezas intervenidas en estilos <em>minimalista</em> y <em>surrealista</em>. Naveg√° la galer√≠a y explor√° el tablero interactivo.</p>
            </aside>

            <main className="space-y-4">
              <section className="p-5 rounded-2xl shadow-lg text-white" style={{background:'var(--bordo-2)'}}>
                <div className="flex items-center gap-2 mb-3">
                  <span>üì∑</span>
                  <h2 className="text-lg font-semibold">Galer√≠a ‚Äî Piezas del tablero</h2>
                </div>
                <GalleryCarousel />
              </section>
            </main>

            <aside className="p-5 rounded-2xl shadow-lg bg-white" style={{borderTop:'4px solid var(--bordo)'}}>
              <h2 className="text-lg font-semibold mb-3" style={{color:'var(--bordo)'}}>Tablero interactivo</h2>
              <ChessBoard />
            </aside>

            <footer className="lg:col-span-3 text-center text-xs text-neutral-700 mt-2">
              ¬© <span id="year"></span> Arte √ó Computaci√≥n ‚Äî Liceo / UTU
            </footer>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App/>);
      document.getElementById('year').textContent = new Date().getFullYear();
    </script>
  </body>
</html>

